[gd_scene load_steps=27 format=3 uid="uid://idyb3vjq4dky"]

[ext_resource type="Texture2D" uid="uid://bo0um6gbf2apv" path="res://assets/enemies/bat.png" id="1_pw7ta"]
[ext_resource type="Script" uid="uid://c77741l56gyhb" path="res://scenes/game/characters/bat.gd" id="1_ttswy"]
[ext_resource type="Texture2D" uid="uid://7srk0k6ximei" path="res://assets/shadows/small_shadow.png" id="2_ymttf"]
[ext_resource type="Shader" uid="uid://dvwvwks2xaaa6" path="res://scenes/game/characters/blink.gdshader" id="3_6yuup"]
[ext_resource type="PackedScene" uid="uid://b6sueieqp6l76" path="res://scenes/collisions/hurtbox.tscn" id="4_4dxry"]
[ext_resource type="PackedScene" uid="uid://c2ivyh2b6aqfj" path="res://scenes/game/characters/stats.tscn" id="5_5ijyl"]
[ext_resource type="PackedScene" uid="uid://bc151gx2jhkb6" path="res://assets/enemies/player_detection_zone.tscn" id="6_h0ik2"]
[ext_resource type="PackedScene" uid="uid://blsigjq1fpj1d" path="res://scenes/collisions/hitbox.tscn" id="7_7sxg7"]
[ext_resource type="PackedScene" uid="uid://dgo2ork35u6jt" path="res://scenes/collisions/soft_collision.tscn" id="8_55m0y"]
[ext_resource type="PackedScene" uid="uid://w11uwvdx4vd6" path="res://assets/enemies/wander_controller.tscn" id="9_gj1qt"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_62ri3"]
resource_local_to_scene = true
shader = ExtResource("3_6yuup")
shader_parameter/active = false

[sub_resource type="AtlasTexture" id="AtlasTexture_ix3ll"]
atlas = ExtResource("1_pw7ta")
region = Rect2(0, 0, 16, 24)

[sub_resource type="AtlasTexture" id="AtlasTexture_5a6d7"]
atlas = ExtResource("1_pw7ta")
region = Rect2(16, 0, 16, 24)

[sub_resource type="AtlasTexture" id="AtlasTexture_pbp40"]
atlas = ExtResource("1_pw7ta")
region = Rect2(32, 0, 16, 24)

[sub_resource type="AtlasTexture" id="AtlasTexture_flgro"]
atlas = ExtResource("1_pw7ta")
region = Rect2(48, 0, 16, 24)

[sub_resource type="AtlasTexture" id="AtlasTexture_rfrwn"]
atlas = ExtResource("1_pw7ta")
region = Rect2(64, 0, 16, 24)

[sub_resource type="SpriteFrames" id="SpriteFrames_8dryq"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_ix3ll")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_5a6d7")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_pbp40")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_flgro")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_rfrwn")
}],
"loop": true,
"name": &"Fly",
"speed": 10.0
}]

[sub_resource type="CircleShape2D" id="CircleShape2D_oa003"]
radius = 4.12311

[sub_resource type="CircleShape2D" id="CircleShape2D_pdftp"]
radius = 64.0

[sub_resource type="CircleShape2D" id="CircleShape2D_xovo7"]
radius = 3.0

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_873si"]

[sub_resource type="CircleShape2D" id="CircleShape2D_20atd"]
radius = 6.08276

[sub_resource type="Animation" id="Animation_qa2ki"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("AnimatedSprite:material:shader_parameter/active")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}

[sub_resource type="Animation" id="Animation_nn0l4"]
resource_name = "Start"
length = 0.2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("AnimatedSprite:material:shader_parameter/active")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [true, false]
}

[sub_resource type="Animation" id="Animation_k1mdp"]
resource_name = "Stop"
length = 0.1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("AnimatedSprite:material:shader_parameter/active")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_8mkj0"]
_data = {
&"RESET": SubResource("Animation_qa2ki"),
&"Start": SubResource("Animation_nn0l4"),
&"Stop": SubResource("Animation_k1mdp")
}

[node name="Bat" type="CharacterBody2D"]
collision_layer = 0
collision_mask = 0
script = ExtResource("1_ttswy")

[node name="Shadow" type="Sprite2D" parent="."]
modulate = Color(1, 1, 1, 0.643137)
texture = ExtResource("2_ymttf")

[node name="AnimatedSprite" type="AnimatedSprite2D" parent="."]
material = SubResource("ShaderMaterial_62ri3")
sprite_frames = SubResource("SpriteFrames_8dryq")
animation = &"Fly"
autoplay = "Fly"
offset = Vector2(0, -12)

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
shape = SubResource("CircleShape2D_oa003")

[node name="Stats" parent="." instance=ExtResource("5_5ijyl")]
_max_health = 3

[node name="PlayerDetectionZone" parent="." instance=ExtResource("6_h0ik2")]
visible = false

[node name="CollisionShape2D" parent="PlayerDetectionZone" index="0"]
modulate = Color(1, 1, 1, 0.372549)
shape = SubResource("CircleShape2D_pdftp")

[node name="BatHitbox" parent="." instance=ExtResource("7_7sxg7")]
visible = false

[node name="CollisionShape2D" parent="BatHitbox" index="0"]
position = Vector2(0, -16)
shape = SubResource("CircleShape2D_xovo7")

[node name="Hurtbox" parent="." instance=ExtResource("4_4dxry")]

[node name="CollisionShape2D" parent="Hurtbox" index="0"]
position = Vector2(0, -15)
shape = SubResource("CapsuleShape2D_873si")

[node name="SoftCollision" parent="." instance=ExtResource("8_55m0y")]
visible = false

[node name="CollisionShape2D" parent="SoftCollision" index="0"]
shape = SubResource("CircleShape2D_20atd")

[node name="WanderController" parent="." instance=ExtResource("9_gj1qt")]

[node name="BlinkAnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
&"": SubResource("AnimationLibrary_8mkj0")
}

[editable path="PlayerDetectionZone"]
[editable path="BatHitbox"]
[editable path="Hurtbox"]
[editable path="SoftCollision"]
